# Default values for actual-assist Helm chart
# This is a YAML-formatted file declaring variables to be passed into templates

# Backend configuration
backend:
  # replicaCount: Keep at 1 for SQLite (file-based, single-writer).
  # For production multi-replica: migrate to PostgreSQL external database.
  # Frontend is stateless and can scale to any number of replicas.
  replicaCount: 1
  image:
    repository: actual-assist-backend
    pullPolicy: IfNotPresent
    tag: ""  # Defaults to Chart.appVersion
  
  service:
    type: ClusterIP
    port: 3000
    targetPort: 3000
  
  resources:
    requests:
      memory: "256Mi"
      cpu: "200m"
    limits:
      memory: "1Gi"
  
  livenessProbe:
    httpGet:
      path: /health
      port: 3000
    initialDelaySeconds: 30
    periodSeconds: 10
  
  readinessProbe:
    httpGet:
      path: /ready
      port: 3000
    initialDelaySeconds: 5
    periodSeconds: 5

# Frontend configuration
frontend:
  replicaCount: 2
  image:
    repository: actual-assist-frontend
    pullPolicy: IfNotPresent
    tag: ""  # Defaults to Chart.appVersion
  
  service:
    type: ClusterIP
    port: 80
    targetPort: 80
  
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
  
  livenessProbe:
    httpGet:
      path: /
      port: 80
    initialDelaySeconds: 30
    periodSeconds: 10
  
  readinessProbe:
    httpGet:
      path: /
      port: 80
    initialDelaySeconds: 5
    periodSeconds: 5

# Storage configuration
storage:
  className: standard
  size: 1Gi
  mountPath: /data

# Docker registry credentials (optional)
imagePullSecrets: []

# Node selector for scheduling
nodeSelector: {}

# Tolerations for scheduling
tolerations: []

# Affinity rules for scheduling
affinity: {}

# Ingress configuration
ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  hosts:
    - host: actual-assist.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: actual-assist-tls
      hosts:
        - actual-assist.example.com

# Secret management - provide values in actual deployment
secrets:
  # Set to false to use an externally managed Secret (Flux + ExternalSecrets/SOPS)
  create: true
  # If using an external Secret, set its name here
  existingSecretName: ""
  openaiApiKey: ""  # OPENAI_API_KEY
  actualServerUrl: ""  # ACTUAL_SERVER_URL
  actualPassword: ""  # ACTUAL_PASSWORD
  actualBudgetId: ""  # ACTUAL_BUDGET_ID (optional, single budget POC)

# Environment variables
env:
  nodeEnv: production
  syncIntervalMinutes: 360  # 6 hours default
  sqliteDbPath: /data/actual-assist.db
  port: 3000
